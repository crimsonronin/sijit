<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
	"http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<title>Testing sijit.ConfigManager.ConfigManager</title>
		<style type="text/css">
			@import "../../../dojo/resources/dojo.css";
            @import "../../../dijit/themes/claro/claro.css";
            @import "../../../sijit/themes/claro/claro.css";
		</style>
		<script
            type="text/javascript"
            src="../../../dojo/dojo.js"
            data-dojo-config="
                isDebug: true,
                popup: true,
                async: true,
                mergeConfigs: [
                    'sijit/Bootstrap/Test/Asset/Config1',
                    'sijit/Bootstrap/Test/Asset/Config2'
                ]
            ">
        </script>
		<script type="text/javascript">
			require([
                'doh/main',
                'dojo/_base/Deferred',
                'dojo/_base/config',
                'sijit/ConfigManager/ConfigManager',
                'dojo/domReady!'
            ],
            function(
                doh,
                Deferred,
                dojoConfig,
                ConfigManager
            ){

                var testConfigMergeDeferred = new Deferred;
                var testConfigMerge = function(){
                    var expectedConfig = {
                        test1: {
                            moduleName: 'Test1',
                            values: {
                                value1: 1,
                                value2: 22
                            }
                        },
                        test2: {
                            moduleName: 'Test2',
                            values: {
                                value1: 1
                            }
                        }
                    }

                    doh.assertEqual(expectedConfig, dojoConfig.serviceManager);
                    testConfigMergeDeferred.resolve(true);
                };

                doh.register([
                   function testConfigMerge(){
                       return testConfigMergeDeferred;
                   }
                ]);
                doh.runOnLoad();

                var configManager = new ConfigManager();
                Deferred.when(configManager.merge(), function(){
                    testConfigMerge();
                });
            });
		</script>
	</head>
	<body class="claro">
        <h1>Testing sijit.ConfigManager.ConfigManager</h1>
	</body>
</html>
